---
{"dg-publish":true,"dg-permalink":"books/35799208/appendix-b","permalink":"/books/35799208/appendix-b/","metatags":{"description":"本章涉及了 pandas 中用于分析数据集的一些新的概念和工具。我们学习了如何读取 CSV 文件，如何处理缺失或重复的数据，如何利用描述性统计量，也见识到了将 DataFrame 转化为交互式图表有多简单。虽然你可能需要一些时间来消化这些知识，但是应该很快就能体会到 pandas 带来的强大力量。本章对 pandas 和 Excel 的 AutoFilter 功能、VLOOKUP 公式、数据透视表、PowerQuery 进行了对比。","og:site_name":"DavonOs","og:title":"Excel Python","og:type":"book","og:url":"https://zuji.eu.org/books/35799208/appendix-b","og:image":"https://file.ituring.com.cn/LargeCover/22038dc37469788a2ed5","og:image:width":"50","og:image:alt":"bookcover"},"created":"2025-09-24 14:58","updated":"2025-09-26 16:51"}
---

# B.1 调试器

如果你在 Excel 中使用过 VBA 调试器，那么我有好消息告诉你：在 VS Code 中进行调试也是类似的体验。首先在 VS Code 中打开配套代码库的 debugging. py 文件。然后点击第 4 行左边的空白处，你会看到一个红点，这就是断点，代码会在此处暂停执行。接下来按下 F 5 键开始调试：命令面板会显示调试配置选项。选择“Python 文件”以调试活动文件，代码会执行到断点处停止。此时这一行代码会高亮显示，代码的执行过程也会暂停，如图 B- 1 所示。在调试时，状态栏会变成橙色。

如果变量部分没有自动显示在左边，那么一定要点击运行菜单来查看变量的值。另外，也可以将鼠标指针悬停在源代码中的变量上，你会在提示信息中看到它的值。在顶部，你会看到调试工具栏，上面从左到右有这样几个按钮：继续、单步跳过、单步调试、单步跳出、重启和停止。把鼠标指针悬停在这些按钮上时，你还会看到对应的键盘快捷键。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-15/dd9a4891-4e25-48b7-8140-6cdacb8609b4/6b0736ed40e0e10fe110f4908e5027413417d0616d0eeac224c7022b8e7cb291.jpg)  
图 B-1：调试器停止在断点处的 VSCode

下面来看看这些按钮都有什么功能。

继续

继续按钮可以让程序继续运行，直到碰到下一个断点或者程序的终点。如果碰到了程序的终点，则调试过程也会停止。

单步跳过

调试器会前进一行。单步跳过意味着调试器在视觉上不会进入不属于当前作用域的那部分代码。例如，它不会进入你在各行中调用的函数，但是这些函数还是会被调用。

单步调试

如果你调用了函数、类，或其他结构，那么单步调试会使调试器进入这个函数或类。如果这个函数或类在不同的文件中，则调试器会为你打开这个文件。

单步跳出

如果你使用单步调试进入了一个函数，则单步跳出会使调试器返回上一层代码，最终你会回到一开始调用单步调试的那一层代码。

重启

停止当前的调试进程并重新启动一个新的调试进程。

停止

停止当前的调试进程。

现在你已经知道各个按钮都是干什么的了，点击单步跳过按钮前进一行代码，看看变量 c 是怎么出现在变量区域中的，然后点击继续完成这个调试练习。

如果保存了调试配置，那么命令面板就不会在你每次按下 F 5 键时弹出来要求你选择调试配置：点击活动栏的运行图标，然后点击“创建 launch. json”文件。此时命令面板会再次显示，当你选择“Python 文件”后，VS Code 会在名为. vscode 的文件夹中创建 launch. json 文件。现在每当你按下 F 5 键时，调试器都会立即启动。如果需要修改配置或是想要再次显示命令面板，则可以在. vscode 目录中编辑或者直接删除 launch. json 文件。

# B.2 VS Code 中的 Jupyter 笔记本

除了在 Web 浏览器中运行 Jupyter 笔记本，也可以直接在 VS Code 中运行 Jupyter 笔记本。除了笔记本的基本功能之外，VS Code 还提供了一个便利的变量浏览器，以及在不丢失单元格功能的前提下将笔记本转换为标准 Python 文件的选项。这样一来调试器的使用就可以更加方便，在不同笔记本之间复制粘贴单元格也会更加便捷。首先通过 VS Code 来运行一个笔记本。

# B.2.1 运行 Jupyter 笔记本

点击活动栏中的资源管理器图标，打开配套代码库中的 ch 05. ipynb。接下来，需要在弹出窗口中点击信任以使我们的笔记本成为受信任的笔记本。为了让笔记本的布局和 VS Code 的其他部分更协调，VS Code 中的笔记本看起来和浏览器中的布局会有点儿不一样。不过使用体验依然是一样的，连同快捷键也是如此。我们首先按下快捷键 Shift+Enter 来运行前 3 个单元格。如果 Jupyter 笔记本服务器没有启动，那么此时服务器会随之启动（你会在笔记本的右上方看到服务器的状态）。然后，点击笔记本顶部菜单中的计算器按钮：如图 B- 2 所示，此时变量浏览器会显示出来，你可以在其中看到现有的所有变量的值。也就是说，你只会在这里看到来自已运行的单元格的变量。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-15/dd9a4891-4e25-48b7-8140-6cdacb8609b4/83019322d341a41f16b41c944d7fa7cec4a97a0cb57c2298b9cf61b1516afb3f.jpg)  
图 B-2：Jupyter 笔记本变量浏览器

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-15/dd9a4891-4e25-48b7-8140-6cdacb8609b4/f9a4ef97e7bdfe7a3166adbfd50e1be17af94014c8e6cf98bf989068ab37bbb2.jpg)

# 在 VSCode 中保存 Jupyter 笔记本

要在 VSCode 中保存笔记本，需要使用笔记本顶部的保存按钮，或是在 Windows 中按下快捷键  $\mathrm{Ctrl} + \mathrm{S}$  ，在 macOS 中按下快捷键 Command- S。“文件 $>$  保存”在这里不起作用。

如果使用了像嵌套列表、NumPy 数组、DataFrame 一类的数据结构，那么可以双击变量来打开数据查看器，你会看到熟悉的表格式视图。图 B- 3 展示了双击变量 df 后显示的数据查看器。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-15/dd9a4891-4e25-48b7-8140-6cdacb8609b4/56a4ab9ffedc9b1d0c359e2fd0df573941598dd07d2fcf77d12d67c95be1c0f2.jpg)  
图 B-3：Jupyter 笔记本数据查看器

VS Code 不仅可以运行标准的 Jupyter 笔记本文件，还可以将笔记本转换为普通的 Python 文件，而且不会丢失单元格。下面来看看怎样做。

# B.2.2 带有代码单元格的 Python 脚本

为了在标准 Python 文件中使用 Jupyter 笔记本单元格，VSCode 使用了一种特殊的组件来表示单元格：# 3+4 #% [markdown] ##这是标题 # #一些markdown内容

Markdown 单元格需要以#%%[markdown]开头，整个单元格必须被标记为注释。如果你想将这样的文件作为笔记本运行，那么可以将鼠标指针悬停在第一个单元格上，点击显示的“运行本单元格及下方单元格”链接。Python 交互式窗口会在右侧打开，如图 B- 4 所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-15/dd9a4891-4e25-48b7-8140-6cdacb8609b4/8eac833aaf5e2aaab369d7f3d73feb10fc0d4fc812ede5f0d7a7c4101e30b3ac.jpg)  
图 B-4：Python 交互式窗口

Python 交互式窗口再次显示为了笔记本。要将文件导出为 ipynb 格式，需要点击 Python 交互式窗口顶部的保存图标。Python 交互式窗口还在底部提供了一个单元格，你可以在这里交互地执行代码。和 Jupyter 笔记本不同，使用常规的 Python 文件可以利用 VSCode 调试器，并使版本控制更加方便，因为输出单元格会被忽略（在版本发生变化时，输出单元格总是会产生大量烦人的信息）。